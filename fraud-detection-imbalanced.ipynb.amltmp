{
  "cells": [
    {
      "cell_type": "markdown",
      "source": [
        "# Fraud Detection with Imbalanced Data - Practical Approach\n",
        "### Optimized for CPU usage on Kaggle\n",
        "#### Uses real data patterns instead of SMOTE synthetic generation"
      ],
      "metadata": {}
    },
    {
      "cell_type": "markdown",
      "source": [
        "## 1. Import Libraries"
      ],
      "metadata": {}
    },
    {
      "cell_type": "code",
      "source": [
        "pip install numpy pandas matplotlib seaborn scikit-learn imbalanced-learn\n"
      ],
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": "Requirement already satisfied: numpy in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (2.2.6)\nRequirement already satisfied: pandas in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (2.3.1)\nRequirement already satisfied: matplotlib in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (3.10.8)\nCollecting seaborn\n  Downloading seaborn-0.13.2-py3-none-any.whl.metadata (5.4 kB)\nCollecting scikit-learn\n  Downloading scikit_learn-1.7.2-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.whl.metadata (11 kB)\nCollecting imbalanced-learn\n  Downloading imbalanced_learn-0.14.1-py3-none-any.whl.metadata (8.9 kB)\nRequirement already satisfied: python-dateutil>=2.8.2 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from pandas) (2.9.0.post0)\nRequirement already satisfied: pytz>=2020.1 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from pandas) (2025.2)\nRequirement already satisfied: tzdata>=2022.7 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from pandas) (2025.2)\nRequirement already satisfied: contourpy>=1.0.1 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from matplotlib) (1.3.2)\nRequirement already satisfied: cycler>=0.10 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from matplotlib) (0.12.1)\nRequirement already satisfied: fonttools>=4.22.0 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from matplotlib) (4.61.1)\nRequirement already satisfied: kiwisolver>=1.3.1 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from matplotlib) (1.4.9)\nRequirement already satisfied: packaging>=20.0 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from matplotlib) (25.0)\nRequirement already satisfied: pillow>=8 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from matplotlib) (12.1.0)\nRequirement already satisfied: pyparsing>=3 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from matplotlib) (3.3.1)\nRequirement already satisfied: scipy>=1.8.0 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from scikit-learn) (1.15.3)\nCollecting joblib>=1.2.0 (from scikit-learn)\n  Downloading joblib-1.5.3-py3-none-any.whl.metadata (5.5 kB)\nCollecting threadpoolctl>=3.1.0 (from scikit-learn)\n  Downloading threadpoolctl-3.6.0-py3-none-any.whl.metadata (13 kB)\nCollecting sklearn-compat<0.2,>=0.1.5 (from imbalanced-learn)\n  Downloading sklearn_compat-0.1.5-py3-none-any.whl.metadata (20 kB)\nRequirement already satisfied: six>=1.5 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from python-dateutil>=2.8.2->pandas) (1.17.0)\nDownloading seaborn-0.13.2-py3-none-any.whl (294 kB)\nDownloading scikit_learn-1.7.2-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (9.7 MB)\n\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m9.7/9.7 MB\u001b[0m \u001b[31m68.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n\u001b[?25hDownloading imbalanced_learn-0.14.1-py3-none-any.whl (235 kB)\nDownloading joblib-1.5.3-py3-none-any.whl (309 kB)\nDownloading sklearn_compat-0.1.5-py3-none-any.whl (20 kB)\nDownloading threadpoolctl-3.6.0-py3-none-any.whl (18 kB)\nInstalling collected packages: threadpoolctl, joblib, scikit-learn, sklearn-compat, seaborn, imbalanced-learn\n\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m6/6\u001b[0m [imbalanced-learn][imbalanced-learn]\n\u001b[1A\u001b[2KSuccessfully installed imbalanced-learn-0.14.1 joblib-1.5.3 scikit-learn-1.7.2 seaborn-0.13.2 sklearn-compat-0.1.5 threadpoolctl-3.6.0\nNote: you may need to restart the kernel to use updated packages.\n"
        }
      ],
      "execution_count": 2,
      "metadata": {
        "gather": {
          "logged": 1767533094986
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "pip install mlflow"
      ],
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": "Requirement already satisfied: mlflow in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (3.8.1)\nRequirement already satisfied: mlflow-skinny==3.8.1 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from mlflow) (3.8.1)\nRequirement already satisfied: mlflow-tracing==3.8.1 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from mlflow) (3.8.1)\nRequirement already satisfied: Flask-CORS<7 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from mlflow) (6.0.2)\nRequirement already satisfied: Flask<4 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from mlflow) (3.1.2)\nRequirement already satisfied: alembic!=1.10.0,<2 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from mlflow) (1.17.2)\nRequirement already satisfied: cryptography<47,>=43.0.0 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from mlflow) (45.0.5)\nRequirement already satisfied: docker<8,>=4.0.0 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from mlflow) (7.1.0)\nRequirement already satisfied: graphene<4 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from mlflow) (3.4.3)\nRequirement already satisfied: gunicorn<24 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from mlflow) (23.0.0)\nRequirement already satisfied: huey<3,>=2.5.0 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from mlflow) (2.5.5)\nRequirement already satisfied: matplotlib<4 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from mlflow) (3.10.8)\nRequirement already satisfied: numpy<3 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from mlflow) (2.2.6)\nRequirement already satisfied: pandas<3 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from mlflow) (2.3.1)\nRequirement already satisfied: pyarrow<23,>=4.0.0 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from mlflow) (20.0.0)\nRequirement already satisfied: scikit-learn<2 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from mlflow) (1.7.2)\nRequirement already satisfied: scipy<2 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from mlflow) (1.15.3)\nRequirement already satisfied: sqlalchemy<3,>=1.4.0 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from mlflow) (2.0.45)\nRequirement already satisfied: cachetools<7,>=5.0.0 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from mlflow-skinny==3.8.1->mlflow) (5.5.2)\nRequirement already satisfied: click<9,>=7.0 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from mlflow-skinny==3.8.1->mlflow) (8.2.1)\nRequirement already satisfied: cloudpickle<4 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from mlflow-skinny==3.8.1->mlflow) (3.1.1)\nRequirement already satisfied: databricks-sdk<1,>=0.20.0 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from mlflow-skinny==3.8.1->mlflow) (0.76.0)\nRequirement already satisfied: fastapi<1 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from mlflow-skinny==3.8.1->mlflow) (0.128.0)\nRequirement already satisfied: gitpython<4,>=3.1.9 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from mlflow-skinny==3.8.1->mlflow) (3.1.46)\nRequirement already satisfied: importlib_metadata!=4.7.0,<9,>=3.7.0 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from mlflow-skinny==3.8.1->mlflow) (8.7.0)\nRequirement already satisfied: opentelemetry-api<3,>=1.9.0 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from mlflow-skinny==3.8.1->mlflow) (1.35.0)\nRequirement already satisfied: opentelemetry-proto<3,>=1.9.0 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from mlflow-skinny==3.8.1->mlflow) (1.35.0)\nRequirement already satisfied: opentelemetry-sdk<3,>=1.9.0 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from mlflow-skinny==3.8.1->mlflow) (1.35.0)\nRequirement already satisfied: packaging<26 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from mlflow-skinny==3.8.1->mlflow) (25.0)\nRequirement already satisfied: protobuf<7,>=3.12.0 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from mlflow-skinny==3.8.1->mlflow) (6.31.1)\nRequirement already satisfied: pydantic<3,>=2.0.0 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from mlflow-skinny==3.8.1->mlflow) (2.11.7)\nRequirement already satisfied: python-dotenv<2,>=0.19.0 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from mlflow-skinny==3.8.1->mlflow) (1.2.1)\nRequirement already satisfied: pyyaml<7,>=5.1 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from mlflow-skinny==3.8.1->mlflow) (6.0.2)\nRequirement already satisfied: requests<3,>=2.17.3 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from mlflow-skinny==3.8.1->mlflow) (2.32.4)\nRequirement already satisfied: sqlparse<1,>=0.4.0 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from mlflow-skinny==3.8.1->mlflow) (0.5.5)\nRequirement already satisfied: typing-extensions<5,>=4.0.0 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from mlflow-skinny==3.8.1->mlflow) (4.14.1)\nRequirement already satisfied: uvicorn<1 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from mlflow-skinny==3.8.1->mlflow) (0.40.0)\nRequirement already satisfied: Mako in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from alembic!=1.10.0,<2->mlflow) (1.3.10)\nRequirement already satisfied: tomli in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from alembic!=1.10.0,<2->mlflow) (2.2.1)\nRequirement already satisfied: cffi>=1.14 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from cryptography<47,>=43.0.0->mlflow) (1.15.0)\nRequirement already satisfied: google-auth~=2.0 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from databricks-sdk<1,>=0.20.0->mlflow-skinny==3.8.1->mlflow) (2.40.3)\nRequirement already satisfied: urllib3>=1.26.0 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from docker<8,>=4.0.0->mlflow) (2.5.0)\nRequirement already satisfied: starlette<0.51.0,>=0.40.0 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from fastapi<1->mlflow-skinny==3.8.1->mlflow) (0.50.0)\nRequirement already satisfied: annotated-doc>=0.0.2 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from fastapi<1->mlflow-skinny==3.8.1->mlflow) (0.0.4)\nRequirement already satisfied: blinker>=1.9.0 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from Flask<4->mlflow) (1.9.0)\nRequirement already satisfied: itsdangerous>=2.2.0 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from Flask<4->mlflow) (2.2.0)\nRequirement already satisfied: jinja2>=3.1.2 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from Flask<4->mlflow) (3.1.6)\nRequirement already satisfied: markupsafe>=2.1.1 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from Flask<4->mlflow) (2.1.1)\nRequirement already satisfied: werkzeug>=3.1.0 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from Flask<4->mlflow) (3.1.3)\nRequirement already satisfied: gitdb<5,>=4.0.1 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from gitpython<4,>=3.1.9->mlflow-skinny==3.8.1->mlflow) (4.0.12)\nRequirement already satisfied: smmap<6,>=3.0.1 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from gitdb<5,>=4.0.1->gitpython<4,>=3.1.9->mlflow-skinny==3.8.1->mlflow) (5.0.2)\nRequirement already satisfied: pyasn1-modules>=0.2.1 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from google-auth~=2.0->databricks-sdk<1,>=0.20.0->mlflow-skinny==3.8.1->mlflow) (0.4.2)\nRequirement already satisfied: rsa<5,>=3.1.4 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from google-auth~=2.0->databricks-sdk<1,>=0.20.0->mlflow-skinny==3.8.1->mlflow) (4.9.1)\nRequirement already satisfied: graphql-core<3.3,>=3.1 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from graphene<4->mlflow) (3.2.7)\nRequirement already satisfied: graphql-relay<3.3,>=3.1 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from graphene<4->mlflow) (3.2.0)\nRequirement already satisfied: python-dateutil<3,>=2.7.0 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from graphene<4->mlflow) (2.9.0.post0)\nRequirement already satisfied: zipp>=3.20 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from importlib_metadata!=4.7.0,<9,>=3.7.0->mlflow-skinny==3.8.1->mlflow) (3.23.0)\nRequirement already satisfied: contourpy>=1.0.1 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from matplotlib<4->mlflow) (1.3.2)\nRequirement already satisfied: cycler>=0.10 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from matplotlib<4->mlflow) (0.12.1)\nRequirement already satisfied: fonttools>=4.22.0 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from matplotlib<4->mlflow) (4.61.1)\nRequirement already satisfied: kiwisolver>=1.3.1 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from matplotlib<4->mlflow) (1.4.9)\nRequirement already satisfied: pillow>=8 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from matplotlib<4->mlflow) (12.1.0)\nRequirement already satisfied: pyparsing>=3 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from matplotlib<4->mlflow) (3.3.1)\nRequirement already satisfied: opentelemetry-semantic-conventions==0.56b0 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from opentelemetry-sdk<3,>=1.9.0->mlflow-skinny==3.8.1->mlflow) (0.56b0)\nRequirement already satisfied: pytz>=2020.1 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from pandas<3->mlflow) (2025.2)\nRequirement already satisfied: tzdata>=2022.7 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from pandas<3->mlflow) (2025.2)\nRequirement already satisfied: annotated-types>=0.6.0 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from pydantic<3,>=2.0.0->mlflow-skinny==3.8.1->mlflow) (0.7.0)\nRequirement already satisfied: pydantic-core==2.33.2 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from pydantic<3,>=2.0.0->mlflow-skinny==3.8.1->mlflow) (2.33.2)\nRequirement already satisfied: typing-inspection>=0.4.0 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from pydantic<3,>=2.0.0->mlflow-skinny==3.8.1->mlflow) (0.4.1)\nRequirement already satisfied: six>=1.5 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from python-dateutil<3,>=2.7.0->graphene<4->mlflow) (1.17.0)\nRequirement already satisfied: charset_normalizer<4,>=2 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from requests<3,>=2.17.3->mlflow-skinny==3.8.1->mlflow) (3.4.2)\nRequirement already satisfied: idna<4,>=2.5 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from requests<3,>=2.17.3->mlflow-skinny==3.8.1->mlflow) (3.10)\nRequirement already satisfied: certifi>=2017.4.17 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from requests<3,>=2.17.3->mlflow-skinny==3.8.1->mlflow) (2025.7.9)\nRequirement already satisfied: pyasn1>=0.1.3 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from rsa<5,>=3.1.4->google-auth~=2.0->databricks-sdk<1,>=0.20.0->mlflow-skinny==3.8.1->mlflow) (0.6.1)\nRequirement already satisfied: joblib>=1.2.0 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from scikit-learn<2->mlflow) (1.5.3)\nRequirement already satisfied: threadpoolctl>=3.1.0 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from scikit-learn<2->mlflow) (3.6.0)\nRequirement already satisfied: greenlet>=1 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from sqlalchemy<3,>=1.4.0->mlflow) (3.3.0)\nRequirement already satisfied: anyio<5,>=3.6.2 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from starlette<0.51.0,>=0.40.0->fastapi<1->mlflow-skinny==3.8.1->mlflow) (3.7.1)\nRequirement already satisfied: sniffio>=1.1 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from anyio<5,>=3.6.2->starlette<0.51.0,>=0.40.0->fastapi<1->mlflow-skinny==3.8.1->mlflow) (1.3.1)\nRequirement already satisfied: exceptiongroup in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from anyio<5,>=3.6.2->starlette<0.51.0,>=0.40.0->fastapi<1->mlflow-skinny==3.8.1->mlflow) (1.3.0)\nRequirement already satisfied: h11>=0.8 in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from uvicorn<1->mlflow-skinny==3.8.1->mlflow) (0.16.0)\nRequirement already satisfied: pycparser in /anaconda/envs/jupyter_env/lib/python3.10/site-packages (from cffi>=1.14->cryptography<47,>=43.0.0->mlflow) (2.22)\nNote: you may need to restart the kernel to use updated packages.\n"
        }
      ],
      "execution_count": 2,
      "metadata": {
        "gather": {
          "logged": 1767540661349
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "import mlflow\n",
        "import mlflow.sklearn\n",
        "MLFLOW_AVAILABLE = True\n",
        "print(\"✅ MLflow is available for experiment tracking\")\n",
        "\n",
        "    "
      ],
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": "✅ MLflow is available for experiment tracking\n"
        }
      ],
      "execution_count": 4,
      "metadata": {
        "gather": {
          "logged": 1767540931944
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "import numpy as np\n",
        "import pandas as pd\n",
        "import matplotlib.pyplot as plt\n",
        "import seaborn as sns\n",
        "from sklearn.model_selection import train_test_split, StratifiedKFold\n",
        "from sklearn.preprocessing import StandardScaler\n",
        "from sklearn.metrics import (classification_report, confusion_matrix, \n",
        "                             roc_auc_score, roc_curve, precision_recall_curve,\n",
        "                             f1_score, precision_score, recall_score)\n",
        "from sklearn.ensemble import RandomForestClassifier\n",
        "from imblearn.under_sampling import RandomUnderSampler\n",
        "import warnings\n",
        "warnings.filterwarnings('ignore')\n",
        "\n",
        "print(\"✓ All libraries imported successfully!\")"
      ],
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": "✓ All libraries imported successfully!\n"
        }
      ],
      "execution_count": 11,
      "metadata": {
        "gather": {
          "logged": 1767542295462
        }
      }
    },
    {
      "cell_type": "markdown",
      "source": [
        "## 2. Load and Explore Data"
      ],
      "metadata": {}
    },
    {
      "cell_type": "code",
      "source": [
        "import pandas as pd\n",
        "\n",
        "blob_url = (\n",
        "    \"https://creditfraudml6672871583.blob.core.windows.net/\"\n",
        "    \"azureml-blobstore-521539cf-a290-4a10-8699-173bdfba39a5/\"\n",
        "    \"fraud_dataset.csv\"\n",
        "    \"?sp=r&st=2026-01-04T13:16:29Z&se=2026-01-04T21:31:29Z&spr=https&sv=2024-11-04&sr=b&sig=w3pMAMrmzU1yZJOVizeNjFmYZNUe3XzG1y6pfV%2Bz9n4%3D\"\n",
        ")\n",
        "\n",
        "\n",
        "df = pd.read_csv(blob_url)\n",
        "\n",
        "print(\"Dataset Shape:\", df.shape)\n",
        "display(df.head())\n"
      ],
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": "Dataset Shape: (6362620, 11)\n"
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": "   step      type    amount     nameOrig  oldbalanceOrg  newbalanceOrig  \\\n0     1   PAYMENT   9839.64  C1231006815       170136.0       160296.36   \n1     1   PAYMENT   1864.28  C1666544295        21249.0        19384.72   \n2     1  TRANSFER    181.00  C1305486145          181.0            0.00   \n3     1  CASH_OUT    181.00   C840083671          181.0            0.00   \n4     1   PAYMENT  11668.14  C2048537720        41554.0        29885.86   \n\n      nameDest  oldbalanceDest  newbalanceDest  isFraud  isFlaggedFraud  \n0  M1979787155             0.0             0.0        0               0  \n1  M2044282225             0.0             0.0        0               0  \n2   C553264065             0.0             0.0        1               0  \n3    C38997010         21182.0             0.0        1               0  \n4  M1230701703             0.0             0.0        0               0  ",
            "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>step</th>\n      <th>type</th>\n      <th>amount</th>\n      <th>nameOrig</th>\n      <th>oldbalanceOrg</th>\n      <th>newbalanceOrig</th>\n      <th>nameDest</th>\n      <th>oldbalanceDest</th>\n      <th>newbalanceDest</th>\n      <th>isFraud</th>\n      <th>isFlaggedFraud</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1</td>\n      <td>PAYMENT</td>\n      <td>9839.64</td>\n      <td>C1231006815</td>\n      <td>170136.0</td>\n      <td>160296.36</td>\n      <td>M1979787155</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1</td>\n      <td>PAYMENT</td>\n      <td>1864.28</td>\n      <td>C1666544295</td>\n      <td>21249.0</td>\n      <td>19384.72</td>\n      <td>M2044282225</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>1</td>\n      <td>TRANSFER</td>\n      <td>181.00</td>\n      <td>C1305486145</td>\n      <td>181.0</td>\n      <td>0.00</td>\n      <td>C553264065</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>1</td>\n      <td>CASH_OUT</td>\n      <td>181.00</td>\n      <td>C840083671</td>\n      <td>181.0</td>\n      <td>0.00</td>\n      <td>C38997010</td>\n      <td>21182.0</td>\n      <td>0.0</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>1</td>\n      <td>PAYMENT</td>\n      <td>11668.14</td>\n      <td>C2048537720</td>\n      <td>41554.0</td>\n      <td>29885.86</td>\n      <td>M1230701703</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n</div>"
          },
          "metadata": {}
        }
      ],
      "execution_count": 12,
      "metadata": {
        "gather": {
          "logged": 1767542313209
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "# Check fraud distribution\n",
        "# Assuming 'Class' is your target column (0=legitimate, 1=fraud)\n",
        "# If your column has a different name, change 'Class' below\n",
        "\n",
        "print(\"Fraud Distribution:\")\n",
        "print(df['isFraud'].value_counts())\n",
        "print(\"\\nFraud Percentage:\", (df['isFraud'].sum() / len(df)) * 100, \"%\")\n",
        "\n",
        "# Visualize distribution\n",
        "plt.figure(figsize=(8, 5))\n",
        "df['isFraud'].value_counts().plot(kind='bar', color=['green', 'red'])\n",
        "plt.title('Original isFraud Distribution', fontsize=14, fontweight='bold')\n",
        "plt.xlabel('isFraud (0=notFraud, 1=Fraud)')\n",
        "plt.ylabel('Count')\n",
        "plt.xticks(rotation=0)\n",
        "plt.show()"
      ],
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": "Fraud Distribution:\nisFraud\n0    6354407\n1       8213\nName: count, dtype: int64\n\nFraud Percentage: 0.12908204481801522 %\n"
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": "<Figure size 800x500 with 1 Axes>",
            "image/png": "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8onOnTtn1/Lwww/L399fP//8s3bs2KF169YVuPzs2bO1adOmXNP/8Ic/KDAw0G3aiRMndOLECcXFxalDhw765ZdfVL16dUlScHCwunXrpkaNGikkJETe3t46fvy45s+fr4MHDyo1NVXPP/+8fSyL69y5c3rsscd06dIlSZKXl5d+//vfKyQkRP/85z+1du3aEq0/PzVr1lT37t311VdfSZJ+/PFHHTlyROHh4fkuk5aWpn/+85/2+H333adWrVopJSVFBw4c0IoVK+x50dHRmjBhgtv7UbduXQ0cONBuk1eXi59++kmS1LdvX7Vo0UIHDhxQUFBQkfZt0aJF6t+/v2rVqqW5c+faP1sLFizQP/7xDz3yyCNFWl92EyZM0N69e926/vz5z39WSEiIJNn9pgsydOhQrVy50h7v1q2b2rdvr3Xr1mnJkiWSpNWrV2vo0KH66KOP8lzH6tWrFR0dre7du2v58uX69ttvJV0+fl9++aUeeuihYu8jcC0QTIFCOnr0qP26du3a+bbLOS/7cjnNmTNHvXv3dpuW3527ly5d0ieffGKP33bbbUpKSlKFChWUlZWluLg4LV++vKBduKqIiAht2LDB7jvZqlUrfffdd5KkjRs3urXdunWrUlJStGbNGh08eFBnz55Vo0aN1Lp1a/uP6ZIlS65ZML3S91GSBg0a5BaaJenXX38tcPnsgSG7+++/P1cwlaRhw4bpzTffzDX9gw8+UEZGhtatW6effvpJqampqlmzprp27aqPP/5YkrRs2TJlZGTIy8vrqvuVnwULFig5Odkenzp1qh577DFJ0pNPPqn69esrIyOj2OsvSIMGDdzGDx8+XGAwzcjIUGZmpqTL/VBnzpwpb29ve75lWfbnvEmTJmrSpIl27NhhB9PC9rucNGmSnnnmmaLujm3s2LH685//LEkaMWKE6tWrpxMnTkiSpk+fXqJg+txzzykpKcntc/bEE0+oTp06hVr+5MmTbj/vDzzwgGbPnm2PP/jgg/r8888lSTNmzNCECRNUuXLlXOtp27atVq9eLS8vL2VkZKhmzZr252jjxo0EUxiHYAo4pGnTprlCaUF27dqltLQ0e7xfv372TSgeHh6Kj48vcTDt37+/2w099evXt4Np9qCXlZWlkSNH6q233tLFixfzXd/PP/9conoK0qlTJ/vpCC+88IIWLFighg0b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Dw8PxcXFae3atbnap6enKz093R5PSUmRJKWmpl77Ym80F5wuAOUFP58oM0FBTleA8uL/5w8UzpW/A5ZlXbWto8H0xIkTyszMVPXq1d2mV69eXbt27crVfty4cRozZkyu6REREdesRgAlE/QqYQHADYZ/gorlzJkzCrrKsXM0mBbVqFGjNHz4cHs8KytLp06dUuXKleVyuRysDDe61NRURURE6NChQwoMDHS6HAAoMX6voaxYlqUzZ84oPDz8qm0dDaZVqlRRhQoVdPz4cbfpx48fV40aNXK19/HxkY+Pj9u04ODga1ki4CYwMJBf4ABuKPxeQ1m42pnSKxy9+cnb21utW7dWYmKiPS0rK0uJiYlq3769g5UBAACgrDl+KX/48OGKj49XmzZt1LZtW02aNElnz57Vo48+6nRpAAAAKEOOB9MHH3xQv/zyi1566SUdO3ZMt9xyixYvXpzrhijAST4+Pho9enSuriQAcL3i9xpM5LIKc+8+AAAAcI05/oB9AAAAQCKYAgAAwBAEUwAAABiBYAoAAAAjEEyBQpgyZYrq1KkjX19ftWvXThs2bHC6JAAolpUrV6pXr14KDw+Xy+XSl19+6XRJgI1gClzF7NmzNXz4cI0ePVpbtmxRixYt1L17dyUnJztdGgAU2dmzZ9WiRQtNmTLF6VKAXHhcFHAV7dq1U3R0tN555x1Jl7+dLCIiQkOGDNHIkSMdrg4Ais/lcmn+/Pm69957nS4FkMQZU6BAFy9e1ObNmxUXF2dP8/DwUFxcnNauXetgZQAA3HgIpkABTpw4oczMzFzfRFa9enUdO3bMoaoAALgxEUwBAABgBIIpUIAqVaqoQoUKOn78uNv048ePq0aNGg5VBQDAjYlgChTA29tbrVu3VmJioj0tKytLiYmJat++vYOVAQBw4/F0ugDAdMOHD1d8fLzatGmjtm3batKkSTp79qweffRRp0sDgCJLS0vTnj177PF9+/Zp69atCg0NVa1atRysDOBxUUChvPPOO5owYYKOHTumW265RZMnT1a7du2cLgsAiiwpKUmxsbG5psfHxyshIaHsCwKyIZgCAADACPQxBQAAgBEIpgAAADACwRQAAABGIJgCAADACARTAAAAGIFgCgAAACMQTAEAAGAEgikAAACMQDAFyomYmBgNGzbM6TKKbMCAAbr33nuv2q5///76+9//fu0LusEV9niXFwkJCQoODrbHp02bpl69ejlXEHCDI5gC5cS8efP0t7/9rVBtBwwYIJfLlWvI/v3aJvn++++1aNEiDR061J5mWZZeeuklhYWFyc/PT3Fxcfrpp58crPLyV0G6XC6dPn3abfr1drxzmj59umJiYhQYGJjn/hVVQkJCnsfjgw8+KJ2CS+D3v/+9tmzZolWrVjldCnBDIpgC5URoaKgCAgIK3b5Hjx46evSo2xAZGZmr3cWLF0uzzGJ5++239Zvf/EaVKlWyp40fP16TJ0/WtGnTtH79evn7+6t79+66cOGCg5Xm73o63jmdO3dOPXr00J///OdSW2dgYGCu49GvX79c7cr6eHh7e+t3v/udJk+eXKbbBcoLgilQTuS8lP/uu+8qKipKvr6+ql69uu6//3639j4+PqpRo4bbUKFCBcXExGjw4MEaNmyYqlSpou7du0uSJk6cqGbNmsnf318RERF6+umnlZaWZq/v5Zdf1i233OK2jUmTJqlOnTr2eGZmpoYPH67g4GBVrlxZI0aMkGVZBe5XZmam5syZ43Z51bIsTZo0SS+88IJ69+6t5s2ba8aMGTpy5Ii+/PLLoh24HPX/4x//UJ06dRQUFKSHHnpIZ86csdukp6dr6NChqlatmnx9fdWxY0dt3LhRkrR//37FxsZKkkJCQuRyuTRgwAB72evleOdl2LBhGjlypG699dYiL5sfl8uV63j4+fnZ+/XBBx8oMjJSvr6+kqTFixerY8eO9r7cfffd2rt3r72+vM5Wb926VS6XS/v377enJSQkqFatWqpYsaL69OmjkydP5qqtV69eWrBggc6fP19q+wvgMoIpUA5t2rRJQ4cO1V//+lft3r1bixcvVufOnQu9/CeffCJvb299++23mjZtmiTJw8NDkydP1s6dO/XJJ59o2bJlGjFiRJHqeuONN5SQkKCPPvpIq1ev1qlTpzR//vwCl9m2bZtSUlLUpk0be9q+fft07NgxxcXF2dOCgoLUrl07rV271p7WpEkTVapUKd+hZ8+ebtvau3evvvzySy1cuFALFy7UihUr9Oqrr9rzR4wYoblz5+qTTz7Rli1bdPPNN6t79+46deqUIiIiNHfuXEnS7t27dfToUb311luFOi4mHe/iKuqxLsiePXs0d+5czZs3T1u3bpUknT17VsOHD9emTZuUmJgoDw8P9enTR1lZWYVe7/r16/XYY49p8ODB2rp1q2JjYzV27Nhc7dq0aaNLly5p/fr1hV43gMLxdLoAAGXv4MGD8vf31913362AgADVrl1bLVu2dGuzcOFCt0vjPXv21BdffCFJioqK0vjx493aZz8bW6dOHY0dO1ZPPfWU3n333ULXNWnSJI0aNUp9+/aVdPlGkyVLlhS4zIEDB1ShQgVVq1bNnnbs2DFJUvXq1d3aVq9e3Z4nSYsWLVJGRka+6/bz83Mbz8rKUkJCgt0lon///kpMTNQrr7yis2fPaurUqUpISLBD1vvvv6///Oc/+vDDD/WnP/1JoaGhkqRq1aq53VAjXT/Hu7iKeqxTUlLcjkelSpXs9+7ixYuaMWOGqlatas+/77773Jb/6KOPVLVqVf33v/9V06ZNC1XjW2+9pR49etgBv379+lqzZo0WL17s1q5ixYoKCgrSgQMHCrVeAIVHMAXKoTvuuEO1a9dW3bp11aNHD/Xo0UN9+vRRxYoV7TaxsbGaOnWqPe7v72+/bt26da51Ll26VOPGjdOuXbuUmpqqS5cu6cKFCzp37pzbevOTkpKio0ePql27dvY0T09PtWnTpsDLy+fPn5ePj49cLtdVt5FT7dq1i9S+Tp06bv10w8LClJycLOny2dSMjAx16NDBnu/l5aW2bdvqhx9+uOq6r5fjXVxFPdYBAQHasmWLPe7h8X8X+GrXru0WSiXpp59+0ksvvaT169frxIkT9pnSgwcPFjqY/vDDD+rTp4/btPbt2+cKptLlIH3u3LlC7w+AwuFSPlAOXfmjP2vWLIWFhemll15SixYt3Prf+fv76+abb7aHsLAwt3nZ7d+/X3fffbeaN2+uuXPnavPmzZoyZYqk/7s5xcPDI1fgKegMWmFVqVJF586dc7sJpkaNGpKk48ePu7U9fvy4PU8q+uVlLy8vt3GXy1WkS8UFuV6Od3EV9Vh7eHi4HY+6deva83IeD+lyv89Tp07p/fff1/r16+3L7NmPhyS3Y1KS43Hq1Klc4RhAyXHGFCinPD09FRcXp7i4OI0ePVrBwcFatmyZfVm3KDZv3qysrCy98cYbdgD4/PPP3dpUrVpVx44dk2VZ9tnNK/0Dpct9QMPCwrR+/Xq7v+ulS5e0efNmtWrVKt9tX7nB57///a/9OjIyUjVq1FBiYqI9LTU1VevXr9fAgQPtZYt6ebkg9erVs/uBXjk7mJGRoY0bN9qX3b29vSVdvumoJJw83sVVmsc6p5MnT2r37t16//331alTJ0nS6tWr3dpcCZFHjx5VSEiIJPfjIUmNGjXK1W903bp1uba3d+9eXbhwIVf3FwAlRzAFyqGFCxfqf//7nzp37qyQkBAtWrRIWVlZatCgQbHWd/PNNysjI0Nvv/22evXq5XaTzhUxMTH65ZdfNH78eN1///1avHixvv76awUGBtptnnnmGb366quKiopSw4YNNXHixKs+E7Nq1apq1aqVVq9ebYdQl8ulYcOGaezYsYqKilJkZKRefPFFhYeHuz08vqiXlwvi7++vgQMH2n1Ja9WqpfHjx+vcuXN67LHH7O25XC4tXLhQd955p/z8/Nz6URaWk8c7L8eOHdOxY8fs565u375dAQEBqlWrlt2vtjSPdU4hISGqXLmypk+frrCwMB08eFAjR450a3PzzTcrIiJCL7/8sl555RX9+OOPeuONN9zaDB06VB06dNDrr7+u3r17a8mSJXlexl+1apXq1q2revXqXbN9AsorLuUD5VBwcLDmzZunLl26qFGjRpo2bZpmzZqlJk2aFGt9LVq00MSJE/Xaa6+padOm+vTTTzVu3Di3No0aNdK7776rKVOmqEWLFtqwYYOee+45tzZ//OMf1b9/f8XHx6t9+/YKCAjI1ecvL48//rg+/fRTt2kjRozQkCFD9Ic//EHR0dFKS0vT4sWL7ccLXQuvvvqq7rvvPvXv31+tWrXSnj17tGTJEvsM3U033aQxY8Zo5MiRql69ugYPHlys7ZTl8b7ysPuCTJs2TS1bttQTTzwhSercubNatmypBQsWFGv/isrDw0OfffaZNm/erKZNm+rZZ5/VhAkT3Np4eXlp1qxZ2rVrl5o3b67XXnst1x33t956q95//3299dZbatGihb755hu98MILubY3a9Yse18BlC6XdS16uQNAGTp//rwaNGig2bNnq3379k6Xc0MZPXq0VqxYoaSkJKdLMcLOnTvVpUsX/fjjjwoKCnK6HOCGw6V8ANc9Pz8/zZgxQydOnHC6lBvO119/rXfeecfpMoxx9OhRzZgxg1AKXCOcMQUAAIAR6GMKAAAAIxBMAQAAYASCKQAAAIxAMAUAAIARCKYAAAAwAsEUAAAARiCYAgAAwAgEUwAAABiBYAoAAAAj/D89JXH3FemerwAAAABJRU5ErkJggg=="
          },
          "metadata": {}
        }
      ],
      "execution_count": 13,
      "metadata": {
        "gather": {
          "logged": 1767542315414
        }
      }
    },
    {
      "cell_type": "markdown",
      "source": [
        "## 3. Data Preprocessing"
      ],
      "metadata": {}
    },
    {
      "cell_type": "code",
      "source": [
        "# Separate features and target\n",
        "X = df.drop(columns=['isFraud', 'nameOrig', 'nameDest'])\n",
        "y = df['isFraud']"
      ],
      "outputs": [],
      "execution_count": 14,
      "metadata": {
        "gather": {
          "logged": 1767542319423
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "X = pd.get_dummies(X, columns=['type'], drop_first=True)\n"
      ],
      "outputs": [],
      "execution_count": 15,
      "metadata": {
        "gather": {
          "logged": 1767542322285
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "# Split into train and test sets (stratified to maintain fraud ratio)\n",
        "from sklearn.model_selection import train_test_split\n",
        "\n",
        "X_train, X_test, y_train, y_test = train_test_split(\n",
        "    X, y,\n",
        "    test_size=0.2,\n",
        "    random_state=42,\n",
        "    stratify=y\n",
        ")\n",
        "print(f\"Training set size: {len(X_train):,}\")\n",
        "print(f\"Test set size: {len(X_test):,}\")\n",
        "print(f\"\\nFraud in training: {y_train.sum()} ({(y_train.sum()/len(y_train)*100):.2f}%)\")\n",
        "print(f\"Fraud in test: {y_test.sum()} ({(y_test.sum()/len(y_test)*100):.2f}%)\")"
      ],
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": "Training set size: 5,090,096\nTest set size: 1,272,524\n\nFraud in training: 6570 (0.13%)\nFraud in test: 1643 (0.13%)\n"
        }
      ],
      "execution_count": 16,
      "metadata": {
        "gather": {
          "logged": 1767542326170
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "from sklearn.preprocessing import StandardScaler\n",
        "\n",
        "scaler = StandardScaler()\n",
        "\n",
        "X_train_scaled = scaler.fit_transform(X_train)\n",
        "X_test_scaled = scaler.transform(X_test)\n",
        "\n",
        "print(\"✓ Features scaled successfully!\")"
      ],
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": "✓ Features scaled successfully!\n"
        }
      ],
      "execution_count": 17,
      "metadata": {
        "gather": {
          "logged": 1767542331270
        }
      }
    },
    {
      "cell_type": "markdown",
      "source": [
        "## 4. Light Undersampling (Keeps Real Data Patterns)"
      ],
      "metadata": {}
    },
    {
      "cell_type": "code",
      "source": [
        "# This creates a more balanced training set without synthetic data\n",
        "# Target: approximately 15% fraud (much more realistic than 30%)\n",
        "# Adjust sampling_strategy to change the ratio (0.15 = 15% fraud)\n",
        "\n",
        "rus = RandomUnderSampler(sampling_strategy=0.15, random_state=42)\n",
        "X_train_resampled, y_train_resampled = rus.fit_resample(X_train_scaled, y_train)\n",
        "\n",
        "print(\"=\"*50)\n",
        "print(\"After Light Undersampling:\")\n",
        "print(f\"Training set size: {len(X_train_resampled):,}\")\n",
        "print(f\"Fraud cases: {y_train_resampled.sum()} ({(y_train_resampled.sum()/len(y_train_resampled)*100):.2f}%)\")\n",
        "print(f\"Legitimate cases: {len(y_train_resampled) - y_train_resampled.sum()}\")\n",
        "print(\"=\"*50)\n",
        "\n",
        "# Visualize new distribution\n",
        "plt.figure(figsize=(10, 5))\n",
        "plt.subplot(1, 2, 1)\n",
        "pd.Series(y_train).value_counts().plot(kind='bar', color=['green', 'red'])\n",
        "plt.title('Original Training Set', fontsize=12, fontweight='bold')\n",
        "plt.xlabel('isFraud')\n",
        "plt.ylabel('Count')\n",
        "plt.xticks(rotation=0)\n",
        "\n",
        "plt.subplot(1, 2, 2)\n",
        "pd.Series(y_train_resampled).value_counts().plot(kind='bar', color=['green', 'red'])\n",
        "plt.title('After Undersampling', fontsize=12, fontweight='bold')\n",
        "plt.xlabel('isFraud')\n",
        "plt.ylabel('Count')\n",
        "plt.xticks(rotation=0)\n",
        "plt.tight_layout()\n",
        "plt.show()"
      ],
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": "==================================================\nAfter Light Undersampling:\nTraining set size: 50,370\nFraud cases: 6570 (13.04%)\nLegitimate cases: 43800\n==================================================\n"
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": "<Figure size 1000x500 with 2 Axes>",
            "image/png": "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2zx8+LC5fPPmzebyZs2aGS4uLub8xIkTDcMwjFatWpVZX48ePWyep2nTpua60p6jadOmhqura4ntbNiwwWw/ceJEm99Xadu+8vcqyRgyZIhNLffff3+JNqGhoUZAQECJGsvy3HPPmW1vv/12Y/369UZubm6Z7bOysoxbbrmlzPcrKSmpxHtS2lT8dwQANcGFCxcMX19fQ5LRoEEDIzMz03B3dzckGa1atbJpe9ddd5X5+Vm8b75yKuo7y/tZbRi2fW/jxo0Nb2/vUvcJSvNHn+vF6yzqb69cXlpfFxYWZly6dMls/+qrr5Zo4+HhYbRp06bUfZS33nqr1H646H0+c+ZMuWo5fPiwMWXKlDLfw9tvv93czkcffVRmO1dXV2PTpk1m2+L7cDfeeGOJ9u3atTP69+9/1X2AouV169Y1goKCSrTv06dPqb/j4vtXVWl/BM6FI92oMs6dO6fjx4+b8+3bty/R5uabb5aHh4c5X/y62yI//vijYmJitHLlSi1btkw333xzmc/54osvmoNZtWvXTitWrNDs2bP1v//7v5V6DTk5OWrQoIH+/e9/65VXXjGXv/HGG+bj2rVra8qUKVq2bJnWr1+vzZs3a8mSJeZp66+++qry8/Mr9fwVdfjwYXXq1EnLly/XypUrzVPShw8frn/+85/67LPPtGXLFn366afmqfybN2/Wjh07yv0cP/30k/r166dVq1bZHMUo/p6Ux4ULF/TBBx9o/vz58vT0lPT7kZDs7GxJ0vr16/XJJ59Ikry9vTVjxgytXLlSDRo0KPEN9B8pupZLkj7//HP17t1bfn5+6tSpkyZPnqxff/3Vpv2LL76ovXv3SpLuuecerVmzRu+//755NHzs2LE6duyYbr31Vm3fvt3m73r58uXavn27tm/fXuYp/wDgrFavXq1z585Jkvr376+goCDzyPTBgwf11VdfmW3nzp1rc5ZU3759zc/PxMRELV++3FzXvn17c93cuXMllf+z+konTpxQSEiIPvjgA3322Wfq37+/Xd+DKx07dkz/+Mc/9PHHHys0NFTS70fe161bJ+n3gT4nTJhgth81apTWrFmjwYMH67vvviuxvZ9//lkjR45UYWGhfH19NXfuXK1bt07Dhg2T9Pv7/MILL5Ray48//qinn35aKSkpeuONN+Tr62v2s3Xr1tUHH3ygjRs36v3339fw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pbCwMHO+oKBACQkJqlu3rurXr69x48bJMAxL3gsAAJwd/T7gPAjdQDWze/duPf3005oyZYoOHjyolJQU3XnnneX++ffee0+enp76/PPPtXDhQkmSq6ur5syZo/379+u9997Tpk2bNG7cuArV9frrrys5OVnvvvuu/vOf/+jMmTNasWJFhbYBAABs0e8D1R+nlwPVzNGjR1WnTh3de++98vX1VdOmTXXrrbfatFm9erV8fHzM+b59+2r58uWSpJYtW2r69Ok27YsP1BIWFqa//vWvGj58uObPn1/uumbNmqXExEQNGDBAkrRw4UKtW7euoi8PAAAUQ78PVH+EbqCa6dWrl5o2barmzZurT58+6tOnjx544AHVrl3bbNOjRw8tWLDAnK9Tp475uGPHjiW2uXHjRk2dOlUHDhxQTk6OLl++rIsXL+q///2vzXbLkp2drV9++UWRkZHmMnd3d3Xq1IlTzQAAuAb0+0D1x+nlQDXj6+urPXv26KOPPlKjRo00YcIERUREKCsry2xTp04dtWjRwpwaNWpks664I0eO6N5771W7du3073//W+np6UpKSpL0+4Ar0u+noV3ZiV66dMmiVwgAAIrQ7wPVH6EbqIbc3d0VHR2t6dOn65tvvtGRI0e0adOmSm0rPT1dhYWFev3119W1a1fddNNNOnHihE2bBg0aKDMz06YDzsjIMB/7+/urUaNG+vLLL81lly9fVnp6eqVqAgAA/x/9PlC9cXo5UM2sXr1aP/74o+68807Vq1dPn332mQoLC9WqVatKba9Fixa6dOmS5s6dq379+tkMtFKke/fuOn36tKZPn65BgwYpJSVFa9eulZ+fn9lm9OjRmjZtmlq2bKnWrVtrxowZNt/CAwCAiqPfB6o/jnQD1UzdunX18ccf6+6771abNm20cOFCffTRR7r55psrtb2IiAjNmDFD//jHP9S2bVt9+OGHmjp1qk2bNm3aaP78+UpKSlJERIR27typZ5991qbNM888o6FDhyouLk5RUVHy9fXVAw88UOnXCQAA6PcBZ+BiMNoBAAAAAACW4Eg3AAAAAAAWIXQDAAAAAGARQjcAAAAAABYhdAMAAAAAYBFCNwAAAAAAFiF0AwAAAABgEUI3AAAAAAAWIXQDAAAAAGARQjcAAAAAABYhdAMAAAAAYBFCNwAAAAAAFiF0AwAAAABgkf8HzcLJAN5bk/gAAAAASUVORK5CYII="
          },
          "metadata": {}
        }
      ],
      "execution_count": 18,
      "metadata": {
        "gather": {
          "logged": 1767542333818
        }
      }
    },
    {
      "cell_type": "markdown",
      "source": [
        "## 5. Model Training - Random Forest"
      ],
      "metadata": {}
    },
    {
      "cell_type": "code",
      "source": [
        "print(\"Training Random Forest model...\\n\")\n",
        "\n",
        "# Random Forest with class weights (handles imbalance well)\n",
        "# n_jobs=2 to limit CPU usage on Kaggle\n",
        "rf_model = RandomForestClassifier(\n",
        "    n_estimators=100,           # Moderate number of trees for CPU efficiency\n",
        "    max_depth=15,               # Limit depth to prevent overfitting and reduce CPU\n",
        "    min_samples_split=10,       # Require more samples to split\n",
        "    min_samples_leaf=5,         # Require more samples in leaf nodes\n",
        "    class_weight='balanced',    # KEY: Automatically handles imbalance\n",
        "    random_state=42,\n",
        "    n_jobs=2,                   # Limit parallel jobs for CPU\n",
        "    verbose=1\n",
        ")\n",
        "\n",
        "# Train on undersampled data\n",
        "rf_model.fit(X_train_resampled, y_train_resampled)\n",
        "\n",
        "print(\"\\n✓ Model training complete!\")"
      ],
      "outputs": [
        {
          "output_type": "stream",
          "name": "stderr",
          "text": "[Parallel(n_jobs=2)]: Using backend ThreadingBackend with 2 concurrent workers.\n[Parallel(n_jobs=2)]: Done  46 tasks      | elapsed:    1.1s\n[Parallel(n_jobs=2)]: Done 100 out of 100 | elapsed:    2.5s finished\n"
        }
      ],
      "execution_count": 19,
      "metadata": {
        "gather": {
          "logged": 1767542339561
        }
      }
    },
    {
      "cell_type": "markdown",
      "source": [
        "## 6. Predictions"
      ],
      "metadata": {}
    },
    {
      "cell_type": "code",
      "source": [
        "# Predict on test set (original imbalanced distribution)\n",
        "y_pred = rf_model.predict(X_test_scaled)\n",
        "y_pred_proba = rf_model.predict_proba(X_test_scaled)[:, 1]\n",
        "\n",
        "print(\"✓ Predictions generated!\")"
      ],
      "outputs": [
        {
          "output_type": "stream",
          "name": "stderr",
          "text": "[Parallel(n_jobs=2)]: Using backend ThreadingBackend with 2 concurrent workers.\n[Parallel(n_jobs=2)]: Done  46 tasks      | elapsed:    1.4s\n[Parallel(n_jobs=2)]: Done 100 out of 100 | elapsed:    3.0s finished\n[Parallel(n_jobs=2)]: Using backend ThreadingBackend with 2 concurrent workers.\n[Parallel(n_jobs=2)]: Done  46 tasks      | elapsed:    1.4s\n[Parallel(n_jobs=2)]: Done 100 out of 100 | elapsed:    3.0s finished\n"
        }
      ],
      "execution_count": 20,
      "metadata": {
        "gather": {
          "logged": 1767542348423
        }
      }
    },
    {
      "cell_type": "markdown",
      "source": [
        "## 7. Model Evaluation"
      ],
      "metadata": {}
    },
    {
      "cell_type": "code",
      "source": [
        "print(\"=\"*70)\n",
        "print(\"MODEL EVALUATION ON TEST SET (Real Imbalanced Distribution)\")\n",
        "print(\"=\"*70)\n",
        "\n",
        "# Classification Report\n",
        "print(\"\\nClassification Report:\")\n",
        "print(classification_report(y_test, y_pred, target_names=['Legitimate', 'Fraud']))"
      ],
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": "======================================================================\nMODEL EVALUATION ON TEST SET (Real Imbalanced Distribution)\n======================================================================\n\nClassification Report:\n              precision    recall  f1-score   support\n\n  Legitimate       1.00      0.99      1.00   1270881\n       Fraud       0.13      0.99      0.23      1643\n\n    accuracy                           0.99   1272524\n   macro avg       0.57      0.99      0.62   1272524\nweighted avg       1.00      0.99      0.99   1272524\n\n"
        }
      ],
      "execution_count": 21,
      "metadata": {
        "gather": {
          "logged": 1767542348786
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "# Confusion Matrix\n",
        "cm = confusion_matrix(y_test, y_pred)\n",
        "print(\"\\nConfusion Matrix:\")\n",
        "print(cm)\n",
        "\n",
        "# Calculate key metrics\n",
        "tn, fp, fn, tp = cm.ravel()\n",
        "print(f\"\\nTrue Negatives: {tn:,}\")\n",
        "print(f\"False Positives: {fp:,}\")\n",
        "print(f\"False Negatives: {fn:,} ← (Missed Fraud - BAD)\")\n",
        "print(f\"True Positives: {tp:,} ← (Caught Fraud - GOOD)\")"
      ],
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": "\nConfusion Matrix:\n[[1260240   10641]\n [     10    1633]]\n\nTrue Negatives: 1,260,240\nFalse Positives: 10,641\nFalse Negatives: 10 ← (Missed Fraud - BAD)\nTrue Positives: 1,633 ← (Caught Fraud - GOOD)\n"
        }
      ],
      "execution_count": 22,
      "metadata": {
        "gather": {
          "logged": 1767542352975
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "# ROC-AUC Score and other metrics\n",
        "roc_auc = roc_auc_score(y_test, y_pred_proba)\n",
        "precision = precision_score(y_test, y_pred)\n",
        "recall = recall_score(y_test, y_pred)\n",
        "f1 = f1_score(y_test, y_pred)\n",
        "\n",
        "print(\"\\n\" + \"=\"*70)\n",
        "print(\"KEY PERFORMANCE METRICS\")\n",
        "print(\"=\"*70)\n",
        "print(f\"🎯 ROC-AUC Score: {roc_auc:.4f}\")\n",
        "print(f\"\\nPrecision: {precision:.4f} (Of predicted fraud, how many were actually fraud?)\")\n",
        "print(f\"Recall: {recall:.4f} (Of all actual fraud, how many did we catch?)\")\n",
        "print(f\"F1-Score: {f1:.4f}\")\n",
        "print(\"=\"*70)"
      ],
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": "\n======================================================================\nKEY PERFORMANCE METRICS\n======================================================================\n🎯 ROC-AUC Score: 0.9996\n\nPrecision: 0.1330 (Of predicted fraud, how many were actually fraud?)\nRecall: 0.9939 (Of all actual fraud, how many did we catch?)\nF1-Score: 0.2347\n======================================================================\n"
        }
      ],
      "execution_count": 23,
      "metadata": {
        "gather": {
          "logged": 1767542355926
        }
      }
    },
    {
      "cell_type": "markdown",
      "source": [
        "## 8. Visualizations"
      ],
      "metadata": {}
    },
    {
      "cell_type": "code",
      "source": [
        "fig, axes = plt.subplots(2, 2, figsize=(15, 12))\n",
        "\n",
        "# 1. Confusion Matrix Heatmap\n",
        "sns.heatmap(cm, annot=True, fmt='d', cmap='Blues', ax=axes[0, 0], cbar=True)\n",
        "axes[0, 0].set_title('Confusion Matrix', fontsize=14, fontweight='bold')\n",
        "axes[0, 0].set_ylabel('Actual')\n",
        "axes[0, 0].set_xlabel('Predicted')\n",
        "axes[0, 0].set_xticklabels(['Legitimate', 'Fraud'])\n",
        "axes[0, 0].set_yticklabels(['Legitimate', 'Fraud'])\n",
        "\n",
        "# 2. ROC Curve\n",
        "fpr, tpr, _ = roc_curve(y_test, y_pred_proba)\n",
        "axes[0, 1].plot(fpr, tpr, color='darkorange', lw=2, label=f'ROC curve (AUC = {roc_auc:.4f})')\n",
        "axes[0, 1].plot([0, 1], [0, 1], color='navy', lw=2, linestyle='--', label='Random Classifier')\n",
        "axes[0, 1].set_xlim([0.0, 1.0])\n",
        "axes[0, 1].set_ylim([0.0, 1.05])\n",
        "axes[0, 1].set_xlabel('False Positive Rate')\n",
        "axes[0, 1].set_ylabel('True Positive Rate')\n",
        "axes[0, 1].set_title('ROC Curve', fontsize=14, fontweight='bold')\n",
        "axes[0, 1].legend(loc=\"lower right\")\n",
        "axes[0, 1].grid(alpha=0.3)\n",
        "\n",
        "# 3. Precision-Recall Curve\n",
        "precision_curve, recall_curve, _ = precision_recall_curve(y_test, y_pred_proba)\n",
        "axes[1, 0].plot(recall_curve, precision_curve, color='green', lw=2)\n",
        "axes[1, 0].set_xlabel('Recall')\n",
        "axes[1, 0].set_ylabel('Precision')\n",
        "axes[1, 0].set_title('Precision-Recall Curve', fontsize=14, fontweight='bold')\n",
        "axes[1, 0].grid(alpha=0.3)\n",
        "axes[1, 0].set_xlim([0.0, 1.0])\n",
        "axes[1, 0].set_ylim([0.0, 1.05])\n",
        "\n",
        "# 4. Feature Importance (Top 15)\n",
        "feature_importance = pd.DataFrame({\n",
        "    'feature': X.columns,\n",
        "    'importance': rf_model.feature_importances_\n",
        "}).sort_values('importance', ascending=False).head(15)\n",
        "\n",
        "axes[1, 1].barh(range(len(feature_importance)), feature_importance['importance'], color='steelblue')\n",
        "axes[1, 1].set_yticks(range(len(feature_importance)))\n",
        "axes[1, 1].set_yticklabels(feature_importance['feature'])\n",
        "axes[1, 1].set_xlabel('Importance')\n",
        "axes[1, 1].set_title('Top 15 Feature Importances', fontsize=14, fontweight='bold')\n",
        "axes[1, 1].invert_yaxis()\n",
        "\n",
        "plt.tight_layout()\n",
        "plt.savefig('fraud_detection_results.png', dpi=300, bbox_inches='tight')\n",
        "plt.show()\n",
        "\n",
        "print(\"✓ Visualizations saved as 'fraud_detection_results.png'\")"
      ],
      "outputs": [],
      "execution_count": 24,
      "metadata": {
        "gather": {
          "logged": 1767534749128
        }
      }
    },
    {
      "cell_type": "markdown",
      "source": [
        "## 9. Threshold Analysis (Optional)"
      ],
      "metadata": {}
    },
    {
      "cell_type": "code",
      "source": [
        "print(\"=\"*70)\n",
        "print(\"THRESHOLD ANALYSIS\")\n",
        "print(\"=\"*70)\n",
        "print(\"Testing different probability thresholds to optimize recall...\\n\")\n",
        "\n",
        "# Try different thresholds to optimize recall (catching fraud)\n",
        "thresholds = [0.3, 0.4, 0.5, 0.6, 0.7]\n",
        "results = []\n",
        "\n",
        "for threshold in thresholds:\n",
        "    y_pred_threshold = (y_pred_proba >= threshold).astype(int)\n",
        "    recall_t = recall_score(y_test, y_pred_threshold)\n",
        "    precision_t = precision_score(y_test, y_pred_threshold)\n",
        "    f1_t = f1_score(y_test, y_pred_threshold)\n",
        "    \n",
        "    results.append({\n",
        "        'Threshold': threshold,\n",
        "        'Recall': f'{recall_t:.4f}',\n",
        "        'Precision': f'{precision_t:.4f}',\n",
        "        'F1-Score': f'{f1_t:.4f}'\n",
        "    })\n",
        "\n",
        "results_df = pd.DataFrame(results)\n",
        "print(\"Performance at Different Thresholds:\")\n",
        "print(results_df.to_string(index=False))\n",
        "print(\"\\nNote: Lower threshold = catch more fraud but more false alarms\")"
      ],
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": "======================================================================\nTHRESHOLD ANALYSIS\n======================================================================\nTesting different probability thresholds to optimize recall...\n\nPerformance at Different Thresholds:\n Threshold Recall Precision F1-Score\n       0.3 0.9982    0.0694   0.1298\n       0.4 0.9963    0.0969   0.1765\n       0.5 0.9939    0.1330   0.2347\n       0.6 0.9890    0.1896   0.3182\n       0.7 0.9769    0.2872   0.4439\n\nNote: Lower threshold = catch more fraud but more false alarms\n"
        }
      ],
      "execution_count": 34,
      "metadata": {
        "gather": {
          "logged": 1767534771314
        }
      }
    },
    {
      "cell_type": "markdown",
      "source": [
        "## 10. Summary and Recommendations"
      ],
      "metadata": {}
    },
    {
      "cell_type": "code",
      "source": [
        "print(\"\\n\" + \"=\"*70)\n",
        "print(\"SUMMARY & RECOMMENDATIONS FOR YOUR TEACHER\")\n",
        "print(\"=\"*70)\n",
        "print(\"\"\"\n",
        "✓ This model is trained on REAL data with minimal resampling\n",
        "✓ Uses class weights to handle imbalance naturally\n",
        "✓ Light undersampling (15% fraud) maintains realistic patterns\n",
        "✓ Evaluation focuses on RECALL (catching fraud) not accuracy\n",
        "✓ ROC-AUC and Precision-Recall curves show true performance\n",
        "✓ This approach mirrors real-world fraud detection systems\n",
        "\n",
        "KEY INSIGHT:\n",
        "A model trained on artificial 30/70 balance will FAIL in production\n",
        "when it encounters real 0.17% fraud rate. This model is trained for\n",
        "reality and will generalize to production environments.\n",
        "\n",
        "WHY SMOTE DOESN'T WORK:\n",
        "- Creates synthetic fraud patterns by interpolation\n",
        "- Real fraud has specific, rare patterns that shouldn't be averaged\n",
        "- Model learns to detect \"SMOTE fraud\" not real fraud\n",
        "- Production deployment would show immediate performance degradation\n",
        "\"\"\")\n",
        "print(\"=\"*70)"
      ],
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": "\n======================================================================\nSUMMARY & RECOMMENDATIONS FOR YOUR TEACHER\n======================================================================\n\n✓ This model is trained on REAL data with minimal resampling\n✓ Uses class weights to handle imbalance naturally\n✓ Light undersampling (15% fraud) maintains realistic patterns\n✓ Evaluation focuses on RECALL (catching fraud) not accuracy\n✓ ROC-AUC and Precision-Recall curves show true performance\n✓ This approach mirrors real-world fraud detection systems\n\nKEY INSIGHT:\nA model trained on artificial 30/70 balance will FAIL in production\nwhen it encounters real 0.17% fraud rate. This model is trained for\nreality and will generalize to production environments.\n\nWHY SMOTE DOESN'T WORK:\n- Creates synthetic fraud patterns by interpolation\n- Real fraud has specific, rare patterns that shouldn't be averaged\n- Model learns to detect \"SMOTE fraud\" not real fraud\n- Production deployment would show immediate performance degradation\n\n======================================================================\n"
        }
      ],
      "execution_count": 35,
      "metadata": {
        "gather": {
          "logged": 1767534801568
        }
      }
    },
    {
      "cell_type": "markdown",
      "source": [
        "## Optional: Save Model"
      ],
      "metadata": {}
    },
    {
      "cell_type": "code",
      "source": [
        "# Uncomment to save the model\n",
        "import joblib\n",
        "joblib.dump(rf_model, 'fraud_detection_model.pkl')\n",
        "joblib.dump(scaler, 'scaler.pkl')\n",
        "print(\"✓ Model and scaler saved!\")"
      ],
      "outputs": [
        {
          "output_type": "error",
          "ename": "NameError",
          "evalue": "name 'rf_model' is not defined",
          "traceback": [
            "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
            "\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)",
            "Cell \u001b[0;32mIn[10], line 3\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[38;5;66;03m# Uncomment to save the model\u001b[39;00m\n\u001b[1;32m      2\u001b[0m \u001b[38;5;28;01mimport\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;21;01mjoblib\u001b[39;00m\n\u001b[0;32m----> 3\u001b[0m joblib\u001b[38;5;241m.\u001b[39mdump(\u001b[43mrf_model\u001b[49m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mfraud_detection_model.pkl\u001b[39m\u001b[38;5;124m'\u001b[39m)\n\u001b[1;32m      4\u001b[0m joblib\u001b[38;5;241m.\u001b[39mdump(scaler, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mscaler.pkl\u001b[39m\u001b[38;5;124m'\u001b[39m)\n\u001b[1;32m      5\u001b[0m \u001b[38;5;28mprint\u001b[39m(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m✓ Model and scaler saved!\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n",
            "\u001b[0;31mNameError\u001b[0m: name 'rf_model' is not defined"
          ]
        }
      ],
      "execution_count": 10,
      "metadata": {
        "gather": {
          "logged": 1767542267398
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "import pickle\n",
        "pickle.dump(rf_model, open(\"fraud_detection_model.pkl\", \"wb\"))\n",
        "pickle.dump(scaler, open(\"scaler.pkl\", \"wb\"))"
      ],
      "outputs": [
        {
          "output_type": "error",
          "ename": "NameError",
          "evalue": "name 'rf_model' is not defined",
          "traceback": [
            "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
            "\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)",
            "Cell \u001b[0;32mIn[9], line 2\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[38;5;28;01mimport\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;21;01mpickle\u001b[39;00m\n\u001b[0;32m----> 2\u001b[0m pickle\u001b[38;5;241m.\u001b[39mdump(\u001b[43mrf_model\u001b[49m, \u001b[38;5;28mopen\u001b[39m(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mfraud_detection_model.pkl\u001b[39m\u001b[38;5;124m\"\u001b[39m, \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mwb\u001b[39m\u001b[38;5;124m\"\u001b[39m))\n\u001b[1;32m      3\u001b[0m pickle\u001b[38;5;241m.\u001b[39mdump(scaler, \u001b[38;5;28mopen\u001b[39m(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mscaler.pkl\u001b[39m\u001b[38;5;124m\"\u001b[39m, \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mwb\u001b[39m\u001b[38;5;124m\"\u001b[39m))\n",
            "\u001b[0;31mNameError\u001b[0m: name 'rf_model' is not defined"
          ]
        }
      ],
      "execution_count": 9,
      "metadata": {
        "gather": {
          "logged": 1767542260755
        }
      }
    }
  ],
  "metadata": {
    "kernelspec": {
      "name": "python3",
      "language": "python",
      "display_name": "Python 3 (ipykernel)"
    },
    "language_info": {
      "name": "python",
      "version": "3.10.18",
      "mimetype": "text/x-python",
      "codemirror_mode": {
        "name": "ipython",
        "version": 3
      },
      "pygments_lexer": "ipython3",
      "nbconvert_exporter": "python",
      "file_extension": ".py"
    },
    "kaggle": {
      "accelerator": "none",
      "dataSources": [],
      "dockerImageVersionId": 31234,
      "isInternetEnabled": true,
      "language": "python",
      "sourceType": "notebook",
      "isGpuEnabled": false
    },
    "microsoft": {
      "ms_spell_check": {
        "ms_spell_check_language": "en"
      },
      "host": {
        "AzureML": {
          "notebookHasBeenCompleted": true
        }
      }
    },
    "kernel_info": {
      "name": "python3"
    },
    "nteract": {
      "version": "nteract-front-end@1.0.0"
    }
  },
  "nbformat": 4,
  "nbformat_minor": 4
}